const webpack = require("webpack");
const chalk = require("chalk");

const paths = require("./paths");
const config = require("../config/webpack.config");

module.exports = () => {
  console.log(chalk.blue("Bulding package..."));
  const beg = Date.now();
  const compiler = webpack(config);
  compiler.run((err, stats) => {
    if (err) {
      console.log(chalk.red(err.message));
    }
    const messages = stats.toJson();
    messages.errors.forEach(message => {
      console.log(chalk.red(message));
    });
    messages.warnings.forEach(message => {
      console.log(chalk.yellow(message));
    });
    if (messages.errors.length === 0) {
      const time = Date.now() - beg;
      console.log(chalk.green(`Finished building package in ${time} ms`));
    }
  });
};
