const fs = require("fs");
const path = require("path");
const paths = require("./paths");
// const babel = require("./babel");
const babel = require("@babel/core");

console.log(process.version);

module.exports = function() {
  fs.mkdirSync(path.resolve(paths.pkg, "dist"));
  const { code } = babel.transformFileSync("src/index.js", {
    babelrc: false,
    plugins: [
      paths.npg.plugins.proposalClassProperties,
      paths.npg.plugins.proposalObjectRestSpread,
      paths.npg.plugins.transformRuntime
    ],
    presets: [[paths.npg.presets.env, { targets: { node: "6.10" } }]]
  });
  fs.writeFileSync("dist/index.js", code, { encoding: "utf8" });
  console.log(code);
};
